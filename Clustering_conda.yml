id: cytof_benchmmark_exercise
description: Benchmark of different clustering algorithms for benchmark phd course.
version: 0.1
benchmarker: "Andrea Sonnenholzner, Frederik Kirk, Helene Wegener, Javier Herranz"
storage: http://omnibenchmark.org:9000
benchmark_yaml_spec: 0.04
storage_api: S3
storage_bucket_name: clusteringexampleconda
software_backend: conda
software_environments:
  py:
    description: "clustbench on py3.12.6"
    conda: envs/clustbench.yml
    envmodule: clustbench
    apptainer: oras://quay.io/imallona/clustering_example/clustbench:latest
  cran:
    description: "CRAN's FCPS"
    conda: envs/fcps.yml
    apptainer: oras://quay.io/imallona/clustering_example/fcps:latest
    envmodule: fcps
metric_collectors:
  - id: plotting
    name: "Single-backend metric collector."
    software_environment: "fcps"
    repository:
      url: https://github.com/imallona/clustering_report
      commit: bbb9d56
    inputs:
      - metrics.scores
    outputs:
      - id: plotting.html
        path: "{input}/{name}/plotting_report.html"
stages:
## clustbench data ##########################################################

  - id: data
    modules:
      - id: data_import
        name: "CyTOF dataset from this place [INSERT THIS PLACE]"
        software_environment: "py"
        repository:
        # THIS SHOULD BE REPLACED WITH THE FINAL DATA REPO
          url: https://github.com/imallona/clustbench_data
          commit: 366c5a2
        parameters: 
        - values: [] #TO BE DONE
    outputs:
      - id: data.matrix
        path: "{input}/{stage}/{module}/{params}/{dataset}.data.gz"
      - id: data.true_labels
        path: "{input}/{stage}/{module}/{params}/{dataset}.labels0.gz"

#   ## clustbench methods (fastcluster) ###################################################################

#   - id: clustering
#     modules:
#       - id: fastcluster
#         name: "fastcluster algorithm"
#         software_environment: "clustbench"
#         repository:
#           url: https://github.com/imallona/clustbench_fastcluster
#           # url: /home/imallona/src/clustbench_fastcluster/
#           commit: "45e43d3"
#         parameters:
#           - values: ["--linkage", "complete"]
#           # - values: ["--linkage", "ward"]
#           # - values: ["--linkage", "average"]
#           # - values: ["--linkage", "weighted"]
#           # - values: ["--linkage", "median"]
#           # - values: ["--linkage", "centroid"]
#       - id: sklearn
#         name: "sklearn"
#         software_environment: "clustbench"
#         repository:
#           url: https://github.com/imallona/clustbench_sklearn
#           #url: /home/imallona/src/clustbench_sklearn
#           commit: 5877378
#         parameters:
#           - values: ["--method", "birch"]
#           # - values: ["--method", "kmeans"]
#           # - values: ["--method", "spectral"] ## too slow
#           # - values: ["--method", "gm"]
#       - id: agglomerative
#         name: "agglomerative"
#         software_environment: "clustbench"
#         repository:
#           url: https://github.com/imallona/clustbench_agglomerative
#           commit: 5454368
#         parameters:
#           - values: ["--linkage", "average"]
#           # - values: ["--linkage", "complete"]
#           # - values: ["--linkage", "ward"]
#       - id: genieclust
#         name: "genieclust"
#         software_environment: "clustbench"
#         repository:
#           url: https://github.com/imallona/clustbench_genieclust
#           commit: 6090043
#         parameters:
#           - values: ["--method", "genie", "--gini_threshold", 0.5]
#           # -  values: ["--method", "gic"]
#           # - values: ["--method", "ica"]
#       - id: fcps
#         name: "fcps"
#         software_environment: "fcps"
#         repository:
#           url: https://github.com/imallona/clustbench_fcps
#           commit: fc37faa
#         parameters:
#           # - values: ["--method", "FCPS_AdaptiveDensityPeak"] # not in Conda
#           - values: ["--method", "FCPS_Minimax", "--seed", 2]
#           # - values: ["--method", "FCPS_MinEnergy", "--seed", 2]
#           # - values: ["--method", "FCPS_HDBSCAN_2", "--seed", 2]
#           # - values: ["--method", "FCPS_HDBSCAN_4", "--seed", 2]
#           # - values: ["--method", "FCPS_HDBSCAN_8", "--seed", 2]
#           # - values: ["--method", "FCPS_Diana", "--seed", 2]
#           # - values: ["--method", "FCPS_Fanny", "--seed", 2]
#           # - values: ["--method", "FCPS_Hardcl", "--seed", 2]
#           # - values: ["--method", "FCPS_Softcl", "--seed", 2]
#           # - values: ["--method", "FCPS_Clara", "--seed", 2]
#           # - values: ["--method", "FCPS_PAM", "--seed", 2]
#       - id: random
#         name: "random"
#         software_environment: "clustbench"
#         repository:
#           url: https://github.com/kaae-2/py-random-cluster
#           commit: 9091c2b
#         parameters:
#           - values: ["--num-clusters", "5", "--seed", "42"]
#     inputs:
#       - entries:
#           - data.matrix
#           - data.true_labels
#     outputs:
#       - id: clustering.predicted_ks_range
#         path: "{input}/{stage}/{module}/{params}/{dataset}_ks_range.labels.gz"

#   - id: metrics
#     modules:
#       - id: partition_metrics
#         name: "clustbench partition metrics"
#         software_environment: "clustbench"
#         repository:
#           url: https://github.com/imallona/clustbench_metrics
#           commit: 9132d45
#         parameters:
#           - values: ["--metric", "normalized_clustering_accuracy"]
#           - values: ["--metric", "adjusted_fm_score"]
#           # - values: ["--metric", "adjusted_mi_score"]
#           # - values: ["--metric", "adjusted_rand_score"]
#           # - values: ["--metric", "fm_score"]
#           # - values: ["--metric", "mi_score"]
#           # - values: ["--metric", "normalized_clustering_accuracy"]
#           # - values: ["--metric", "normalized_mi_score"]
#           # - values: ["--metric", "normalized_pivoted_accuracy"]
#           # - values: ["--metric", "pair_sets_index"]
#           # - values: ["--metric", "rand_score"]
#     inputs:
#       - entries:
#           - clustering.predicted_ks_range
#           - data.true_labels
#     outputs:
#       - id: metrics.scores
#         path: "{input}/{stage}/{module}/{params}/{dataset}.scores.gz"
